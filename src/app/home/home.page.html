<app-stars-efects></app-stars-efects>

<app-background></app-background>
<div class="contianer">
  <div class="mobile">
    <ion-item>
      <ion-input
        type="file"
        (change)="handleFileUpload($event)"
        multiple
      ></ion-input>
    </ion-item>
    <ion-list class="list">
      <ion-item
        *ngFor="let file of files; let i = index"
        [ngClass]="{ 'selected': i === selectedIndex }"
      >
        <ion-label (click)="selectFile(file,i)">{{ file.name }}</ion-label>
        <app-button
          slot="start"
          (click)="deleteFile(i)"
          icon="close-circle"
          [iconOnly]="true"
          type="clear"
          color="red"
        >
        </app-button>
      </ion-item>
    </ion-list>

    <div *ngIf="selectedFile" class="data-audio">
      <div class="audio">
        <audio
          id="audioPlayer"
          [src]="audioURL"
          (timeupdate)="updateTime()"
          (loadedmetadata)="updateTime()"
          #audioPlayer
        ></audio>

        <div class="time">
          <!-- <div>Current Time: {{ formatSecondsToMinutes(currentTime)}}m</div>
          <div>Duration: {{ formatSecondsToMinutes(duration) }}m</div>
   -->
          <ion-item>
            <ion-range
              min="0"
              [max]="duration"
              step="0.1"
              [(ngModel)]="currentTime"
              (ionChange)="changeTime($event)"
            >
              <ion-label slot="start"
                >{{ formatSecondsToMinutes(currentTime) }}s</ion-label
              >
              <ion-label slot="end"
                >{{ formatSecondsToMinutes(duration) }}s</ion-label
              >
            </ion-range>
          </ion-item>
        </div>
        <div class="actions">
          <app-button
            icon="play-back"
            [iconOnly]="true"
            color="blue"
            radius="50%"
            (click)="rewind()"
          >
          </app-button>

          <app-button
            *ngIf="!isPlaying"
            icon="play"
            [iconOnly]="true"
            color="blue"
            radius="50%"
            (click)="play()"
          >
          </app-button>
          <app-button
            *ngIf="isPlaying"
            icon="pause"
            [iconOnly]="true"
            color="blue"
            radius="50%"
            (click)="pause()"
          >
          </app-button>

          <app-button
            icon="stop"
            [iconOnly]="true"
            color="blue"
            radius="50%"
            (click)="stop()"
          >
          </app-button>

          <app-button
            icon="play-forward"
            [iconOnly]="true"
            color="blue"
            radius="50%"
            (click)="forward()"
          >
          </app-button>
        </div>

        <h2>Velocidad: {{playbackRate}}</h2>
      </div>

      <ion-item>
        <ion-label>Speed</ion-label>
        <ion-range
          min="0.5"
          max="2"
          step="0.1"
          [(ngModel)]="playbackRate"
          (ionChange)="updatePlaybackRate()"
        >
          <ion-label slot="start">0.5x</ion-label>
          <ion-label slot="end">2x</ion-label>
        </ion-range>
      </ion-item>
      <ion-item>
        <ion-label>Select Speed</ion-label>
        <ion-select
          [(ngModel)]="playbackRate"
          (ionChange)="updatePlaybackRate()"
        >
          <ion-select-option [value]="0.70">0.70x</ion-select-option>
          <ion-select-option [value]="0.75">0.75x</ion-select-option>
          <ion-select-option [value]="0.80">0.80x</ion-select-option>
          <ion-select-option [value]="0.85">0.85x</ion-select-option>
          <ion-select-option [value]="0.90">0.90x</ion-select-option>
          <ion-select-option [value]="0.95">0.95x</ion-select-option>
          <ion-select-option [value]="1.00">1.00x</ion-select-option>
          <ion-select-option [value]="1.05">1.05x</ion-select-option>
          <ion-select-option [value]="1.10">1.10x</ion-select-option>
          <ion-select-option [value]="1.15">1.15x</ion-select-option>
          <ion-select-option [value]="1.20">1.20x</ion-select-option>
          <ion-select-option [value]="1.25">1.25x</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label>Volume</ion-label>
        <ion-range
          min="0"
          max="1"
          step="0.1"
          [(ngModel)]="volume"
          (ionChange)="updateVolume()"
        >
          <ion-label slot="start">0</ion-label>
          <ion-label slot="end">1</ion-label>
        </ion-range>
      </ion-item>
    </div>
    <app-button
      text="RESET APP"
      type="solid"
      color="red"
      size="md"
      margin="20px auto"
      (click)="clearFiles()"
    >
    </app-button>
  </div>
</div>
